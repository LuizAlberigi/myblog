---
title: "Regressão Linear"
author: "Luiz Alberigi"
date: "2025-11-20"
categories: [calcular, code, python, regreção]
image: "regressão.png"
jupyter: python3
---
Neste post vamos realizar uma **regressão linear simples** utilizando Python, NumPy e Plotly.  

Carregando os dados

```{python}

import numpy as np

# Carregar arquivos do Jupyter (PRECISA estar na mesma pasta do .ipynb)
X = np.loadtxt("X.txt")
y = np.loadtxt("y.txt")

# Garantir formato coluna
X = X.reshape(-1, 1)

print("Primeiros valores de X:", X[:5].flatten())
print("Primeiros valores de y:", y[:5])
```


Montar a matriz do modelo

```{python}

# Matriz de design
X_design = np.hstack([np.ones((X.shape[0], 1)), X])

X_design[:5]

```

Ajustando o modelo via Equação Normal


```{python}

# Equação normal
beta = np.linalg.inv(X_design.T @ X_design) @ (X_design.T @ y)

b0, b1 = beta

print("Intercepto (b0):", b0)
print("Inclinação (b1):", b1)


```

Gerar as previsões (y_pred)

```{python}

# Previsões
y_pred = b0 + b1 * X

```

Gráfico interativo (Plotly)


```{python}
import pandas as pd
import plotly.express as px

# Construir DataFrame
df = pd.DataFrame({
    "X": X.flatten(),
    "y_real": y,
    "y_pred": y_pred.flatten()
})

# Gráfico
fig = px.scatter(df, x="X", y="y_real", title="Regressão Linear — Dados Reais")
fig.add_traces(px.line(df, x="X", y="y_pred").data)
fig.show()


```

Métricas do modelo


```{python}

from sklearn.metrics import r2_score, mean_squared_error

r2 = r2_score(y, y_pred)
mse = mean_squared_error(y, y_pred)

print("R²:", r2)
print("MSE:", mse)

```