{
  "hash": "07e8e70681d71bc3f11b06140c1a0c99",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Gráfico da Cotação do Dólar por Período\"\nauthor: \"Luiz Alberigi\"\ndate: \"2025-11-19\"\ncategories: [cotação, code, python, dólar]\nimage: \"pngtree-financial-growth-a-rising-graph-stacks-of-money-and-coins-illustrate-png-image_15331270.png\"\njupyter: python3\n---\n\nEste post tem como objetivo desenvolver uma rotina em *Python* que, a partir de uma string no formato \"MMYYYY\", consulte a API PTAX do Banco Central do Brasil e retorne um gráfico de linha mostrando a **cotação do dólar** ao longo do mês informado.\n\n::: {#a50e3067 .cell execution_count=1}\n``` {.python .cell-code}\n# --------------------------------------\n# Importações necessárias\n# --------------------------------------\nimport requests\nimport pandas as pd\nimport plotly.express as px\nimport calendar\nfrom datetime import datetime\n\n# --------------------------------------\n# Função principal exigida na tarefa\n# --------------------------------------\ndef grafico_cotacao_mensal():\n    \"\"\"\n    Consulta a API PTAX e exibe um gráfico de linha\n    com a cotação de venda do dólar no mês 06/2023.\n    \"\"\"\n\n    # Definir o mês e ano fixos solicitados\n    mmyyyy = \"062023\"\n\n    # 1) Converter string em data\n    first_date = datetime.strptime(mmyyyy, \"%m%Y\")\n\n    # Definir o primeiro e último dia do mês\n    data_inicial = first_date.replace(day=1)\n    ultimo_dia = calendar.monthrange(first_date.year, first_date.month)[1]\n    data_final = first_date.replace(day=ultimo_dia)\n\n    # Formatar para o padrão exigido pela API MM-DD-YYYY\n    di = data_inicial.strftime(\"%m-%d-%Y\")\n    df = data_final.strftime(\"%m-%d-%Y\")\n\n    # 2) Construção da URL da API PTAX\n    url = (\n        \"https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/\"\n        \"CotacaoDolarPeriodo(dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)\"\n        f\"?@dataInicial='{di}'&@dataFinalCotacao='{df}'&$format=json\"\n    )\n\n    # 3) Requisição HTTP\n    resposta = requests.get(url).json()\n\n    # 4) Conversão para DataFrame\n    dados = pd.DataFrame(resposta[\"value\"])\n\n    # Ajuste na coluna de data\n    dados[\"dataHoraCotacao\"] = pd.to_datetime(dados[\"dataHoraCotacao\"])\n\n    # 5) Gráfico de linha com Plotly\n    fig = px.line(\n        dados,\n        x=\"dataHoraCotacao\",\n        y=\"cotacaoVenda\",\n        title=\"Cotação do Dólar – 06/2023\",\n        markers=True\n    )\n\n    # Legendas\n    fig.update_layout(\n        xaxis_title=\"Data\",\n        yaxis_title=\"Cotação de Venda (R$)\"\n    )\n\n    # Exibir gráfico\n    fig.show()\n\n    return dados\n```\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}